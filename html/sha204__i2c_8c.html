<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>NodaMBusGateway: lib_atsha/sha204_i2c.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NodaMBusGateway
   &#160;<span id="projectnumber">1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_156ca63535088a91e4fcbec9d50bdae7.html">lib_atsha</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">sha204_i2c.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions for I2C Physical Hardware Independent Layer of SHA204 Library.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;LUFA/Drivers/Peripheral/TWI.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="sha204__physical_8h_source.html">sha204_physical.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="sha204__lib__return__codes_8h_source.html">sha204_lib_return_codes.h</a>&quot;</code><br/>
<code>#include &lt;util/delay.h&gt;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a113e9fb340fc21ad63077c90b675be9f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a113e9fb340fc21ad63077c90b675be9f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha204__i2c_8c.html#a113e9fb340fc21ad63077c90b675be9f">SHA204_I2C_DEFAULT_ADDRESS</a>&#160;&#160;&#160;((uint8_t) 0xC8)</td></tr>
<tr class="memdesc:a113e9fb340fc21ad63077c90b675be9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">TWI address used at SHA204 library startup. <br/></td></tr>
<tr class="separator:a113e9fb340fc21ad63077c90b675be9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a617ddf3304dbe7c32b562371bc106dcd"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha204__i2c_8c.html#a617ddf3304dbe7c32b562371bc106dcd">i2c_word_address</a> { <a class="el" href="sha204__i2c_8c.html#a617ddf3304dbe7c32b562371bc106dcdaf95c9109273c47f4a77012cc480371f5">SHA204_I2C_PACKET_FUNCTION_RESET</a>, 
<a class="el" href="sha204__i2c_8c.html#a617ddf3304dbe7c32b562371bc106dcdad88b6f4403c33008d226ad8f3e5a92a1">SHA204_I2C_PACKET_FUNCTION_SLEEP</a>, 
<a class="el" href="sha204__i2c_8c.html#a617ddf3304dbe7c32b562371bc106dcda35bb617e4bb4384c180d913d604bc468">SHA204_I2C_PACKET_FUNCTION_IDLE</a>, 
<a class="el" href="sha204__i2c_8c.html#a617ddf3304dbe7c32b562371bc106dcdaf9b581a1f02944f1be24d37b0c44fece">SHA204_I2C_PACKET_FUNCTION_NORMAL</a>
 }</td></tr>
<tr class="memdesc:a617ddf3304dbe7c32b562371bc106dcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">This enumeration lists all packet types sent to a SHA204 device.  <a href="sha204__i2c_8c.html#a617ddf3304dbe7c32b562371bc106dcd">More...</a><br/></td></tr>
<tr class="separator:a617ddf3304dbe7c32b562371bc106dcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3e90779b37cd1b3a4d32321d9d8b772"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha204__i2c_8c.html#aa3e90779b37cd1b3a4d32321d9d8b772">i2c_read_write_flag</a> { <a class="el" href="sha204__i2c_8c.html#aa3e90779b37cd1b3a4d32321d9d8b772adbf6337ed546b3c21fd08c397a346bb2">I2C_WRITE</a> = (uint8_t) 0x00, 
<a class="el" href="sha204__i2c_8c.html#aa3e90779b37cd1b3a4d32321d9d8b772a30040082a257338fe25e5bd5136bc9a8">I2C_READ</a> = (uint8_t) 0x01
 }</td></tr>
<tr class="memdesc:aa3e90779b37cd1b3a4d32321d9d8b772"><td class="mdescLeft">&#160;</td><td class="mdescRight">This enumeration lists flags for I2C read or write addressing.  <a href="sha204__i2c_8c.html#aa3e90779b37cd1b3a4d32321d9d8b772">More...</a><br/></td></tr>
<tr class="separator:aa3e90779b37cd1b3a4d32321d9d8b772"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae7e29db9eaad7e60904776025d48c614"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha204__i2c_8c.html#ae7e29db9eaad7e60904776025d48c614">sha204p_set_device_id</a> (uint8_t id)</td></tr>
<tr class="memdesc:ae7e29db9eaad7e60904776025d48c614"><td class="mdescLeft">&#160;</td><td class="mdescRight">This I2C function sets the I2C address. Communication functions will use this address.  <a href="#ae7e29db9eaad7e60904776025d48c614">More...</a><br/></td></tr>
<tr class="separator:ae7e29db9eaad7e60904776025d48c614"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe00f5d947448aa818379980513870ba"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abe00f5d947448aa818379980513870ba"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha204__i2c_8c.html#abe00f5d947448aa818379980513870ba">sha204p_init</a> (void)</td></tr>
<tr class="memdesc:abe00f5d947448aa818379980513870ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">This I2C function initializes the hardware. <br/></td></tr>
<tr class="separator:abe00f5d947448aa818379980513870ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae68de7f5e47843b0a8ecdd30d24442b1"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha204__i2c_8c.html#ae68de7f5e47843b0a8ecdd30d24442b1">sha204p_wakeup</a> (void)</td></tr>
<tr class="memdesc:ae68de7f5e47843b0a8ecdd30d24442b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This I2C function generates a Wake-up pulse and delays.  <a href="#ae68de7f5e47843b0a8ecdd30d24442b1">More...</a><br/></td></tr>
<tr class="separator:ae68de7f5e47843b0a8ecdd30d24442b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ccf4e6d4f415fdde1456cf0fa453d57"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha204__i2c_8c.html#a1ccf4e6d4f415fdde1456cf0fa453d57">i2c_receive_bytes</a> (uint8_t count, uint8_t *data)</td></tr>
<tr class="memdesc:a1ccf4e6d4f415fdde1456cf0fa453d57"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function creates a Start condition and sends the TWI address.  <a href="#a1ccf4e6d4f415fdde1456cf0fa453d57">More...</a><br/></td></tr>
<tr class="separator:a1ccf4e6d4f415fdde1456cf0fa453d57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1e94f89c3aebcdd002726e9337be948"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha204__i2c_8c.html#ab1e94f89c3aebcdd002726e9337be948">sha204p_send_command</a> (uint8_t count, uint8_t *command)</td></tr>
<tr class="memdesc:ab1e94f89c3aebcdd002726e9337be948"><td class="mdescLeft">&#160;</td><td class="mdescRight">This I2C function sends a command to the device.  <a href="#ab1e94f89c3aebcdd002726e9337be948">More...</a><br/></td></tr>
<tr class="separator:ab1e94f89c3aebcdd002726e9337be948"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7ee8303b4a2a2c1189517b31961730a"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha204__i2c_8c.html#ac7ee8303b4a2a2c1189517b31961730a">sha204p_idle</a> (void)</td></tr>
<tr class="memdesc:ac7ee8303b4a2a2c1189517b31961730a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This I2C function puts the SHA204 device into idle state.  <a href="#ac7ee8303b4a2a2c1189517b31961730a">More...</a><br/></td></tr>
<tr class="separator:ac7ee8303b4a2a2c1189517b31961730a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51b4c64d8886eb7811957f6b547578bf"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha204__i2c_8c.html#a51b4c64d8886eb7811957f6b547578bf">sha204p_sleep</a> (void)</td></tr>
<tr class="memdesc:a51b4c64d8886eb7811957f6b547578bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">This I2C function puts the SHA204 device into low-power state.  <a href="#a51b4c64d8886eb7811957f6b547578bf">More...</a><br/></td></tr>
<tr class="separator:a51b4c64d8886eb7811957f6b547578bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd5907eecf92a0bb21365ac77d596769"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha204__i2c_8c.html#abd5907eecf92a0bb21365ac77d596769">sha204p_reset_io</a> (void)</td></tr>
<tr class="memdesc:abd5907eecf92a0bb21365ac77d596769"><td class="mdescLeft">&#160;</td><td class="mdescRight">This I2C function resets the I/O buffer of the SHA204 device.  <a href="#abd5907eecf92a0bb21365ac77d596769">More...</a><br/></td></tr>
<tr class="separator:abd5907eecf92a0bb21365ac77d596769"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade67d37ad71a35d1227ccbcb4c4601f8"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha204__i2c_8c.html#ade67d37ad71a35d1227ccbcb4c4601f8">sha204p_receive_response</a> (uint8_t size, uint8_t *response)</td></tr>
<tr class="memdesc:ade67d37ad71a35d1227ccbcb4c4601f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This TWI function receives a response from the SHA204 device.  <a href="#ade67d37ad71a35d1227ccbcb4c4601f8">More...</a><br/></td></tr>
<tr class="separator:ade67d37ad71a35d1227ccbcb4c4601f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3db548187ba3e62f75e488de445c0bf4"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha204__i2c_8c.html#a3db548187ba3e62f75e488de445c0bf4">sha204p_resync</a> (uint8_t size, uint8_t *response)</td></tr>
<tr class="memdesc:a3db548187ba3e62f75e488de445c0bf4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This I2C function resynchronizes communication.  <a href="#a3db548187ba3e62f75e488de445c0bf4">More...</a><br/></td></tr>
<tr class="separator:a3db548187ba3e62f75e488de445c0bf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions for I2C Physical Hardware Independent Layer of SHA204 Library. </p>
<dl class="section author"><dt>Author</dt><dd>Atmel Crypto Products </dd></dl>
<dl class="section date"><dt>Date</dt><dd>February 2, 2011 </dd></dl>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="aa3e90779b37cd1b3a4d32321d9d8b772"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="sha204__i2c_8c.html#aa3e90779b37cd1b3a4d32321d9d8b772">i2c_read_write_flag</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This enumeration lists flags for I2C read or write addressing. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="aa3e90779b37cd1b3a4d32321d9d8b772adbf6337ed546b3c21fd08c397a346bb2"></a>I2C_WRITE</em>&nbsp;</td><td class="fielddoc">
<p>write command flag </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="aa3e90779b37cd1b3a4d32321d9d8b772a30040082a257338fe25e5bd5136bc9a8"></a>I2C_READ</em>&nbsp;</td><td class="fielddoc">
<p>read command flag </p>
</td></tr>
</table>

</div>
</div>
<a class="anchor" id="a617ddf3304dbe7c32b562371bc106dcd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="sha204__i2c_8c.html#a617ddf3304dbe7c32b562371bc106dcd">i2c_word_address</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This enumeration lists all packet types sent to a SHA204 device. </p>
<p>The following byte stream is sent to a SHA204 TWI device: {I2C start} {I2C address} {word address} [{data}] {I2C stop}. Data are only sent after a word address of value <a class="el" href="sha204__i2c_8c.html#a617ddf3304dbe7c32b562371bc106dcdaf9b581a1f02944f1be24d37b0c44fece" title="Write / evaluate data that follow this word address byte.">SHA204_I2C_PACKET_FUNCTION_NORMAL</a>. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="a617ddf3304dbe7c32b562371bc106dcdaf95c9109273c47f4a77012cc480371f5"></a>SHA204_I2C_PACKET_FUNCTION_RESET</em>&nbsp;</td><td class="fielddoc">
<p>Reset device. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a617ddf3304dbe7c32b562371bc106dcdad88b6f4403c33008d226ad8f3e5a92a1"></a>SHA204_I2C_PACKET_FUNCTION_SLEEP</em>&nbsp;</td><td class="fielddoc">
<p>Put device into Sleep mode. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a617ddf3304dbe7c32b562371bc106dcda35bb617e4bb4384c180d913d604bc468"></a>SHA204_I2C_PACKET_FUNCTION_IDLE</em>&nbsp;</td><td class="fielddoc">
<p>Put device into Idle mode. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a617ddf3304dbe7c32b562371bc106dcdaf9b581a1f02944f1be24d37b0c44fece"></a>SHA204_I2C_PACKET_FUNCTION_NORMAL</em>&nbsp;</td><td class="fielddoc">
<p>Write / evaluate data that follow this word address byte. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a1ccf4e6d4f415fdde1456cf0fa453d57"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_receive_bytes </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function creates a Start condition and sends the TWI address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">read</td><td><a class="el" href="sha204__i2c_8c.html#aa3e90779b37cd1b3a4d32321d9d8b772a30040082a257338fe25e5bd5136bc9a8" title="read command flag">I2C_READ</a> for reading, <a class="el" href="sha204__i2c_8c.html#aa3e90779b37cd1b3a4d32321d9d8b772adbf6337ed546b3c21fd08c397a346bb2" title="write command flag">I2C_WRITE</a> for writing </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status of the I2C operationThis function receives bytes from an I2C device and sends a Stop.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">count</td><td>number of bytes to receive </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">data</td><td>pointer to rx buffer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status of the operation </dd></dl>

</div>
</div>
<a class="anchor" id="ac7ee8303b4a2a2c1189517b31961730a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t sha204p_idle </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This I2C function puts the SHA204 device into idle state. </p>
<dl class="section return"><dt>Returns</dt><dd>status of the operation </dd></dl>

</div>
</div>
<a class="anchor" id="ade67d37ad71a35d1227ccbcb4c4601f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t sha204p_receive_response </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This TWI function receives a response from the SHA204 device. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>size of rx buffer </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">response</td><td>pointer to rx buffer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status of the operation </dd></dl>

</div>
</div>
<a class="anchor" id="abd5907eecf92a0bb21365ac77d596769"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t sha204p_reset_io </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This I2C function resets the I/O buffer of the SHA204 device. </p>
<dl class="section return"><dt>Returns</dt><dd>status of the operation </dd></dl>

</div>
</div>
<a class="anchor" id="a3db548187ba3e62f75e488de445c0bf4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t sha204p_resync </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This I2C function resynchronizes communication. </p>
<p>Parameters are not used for I2C.<br/>
 Re-synchronizing communication is done in a maximum of three steps listed below. This function implements the first step. Since steps 2 and 3 (sending a Wake-up token and reading the response) are the same for I2C and SWI, they are implemented in the communication layer (<a class="el" href="sha204__comm_8c.html#a4f083ed7cffa75e00c608d7e379bb2d0" title="This function re-synchronizes communication.">sha204c_resync</a>). </p>
<ol>
<li>
To ensure an IO channel reset, the system should send the standard I2C software reset sequence, as follows: <ul>
<li>
a Start condition </li>
<li>
nine cycles of SCL, with SDA held high </li>
<li>
another Start condition </li>
<li>
a Stop condition </li>
</ul>
It should then be possible to send a read sequence and if synchronization has completed properly the ATSHA204 will acknowledge the device address. The chip may return data or may leave the bus floating (which the system will interpret as a data value of 0xFF) during the data periods.<br/>
 If the chip does acknowledge the device address, the system should reset the internal address counter to force the ATSHA204 to ignore any partial input command that may have been sent. This can be accomplished by sending a write sequence to word address 0x00 (Reset), followed by a Stop condition.  </li>
<li>
If the chip does NOT respond to the device address with an ACK, then it may be asleep. In this case, the system should send a complete Wake token and wait t_whi after the rising edge. The system may then send another read sequence and if synchronization has completed the chip will acknowledge the device address.  </li>
<li>
If the chip still does not respond to the device address with an acknowledge, then it may be busy executing a command. The system should wait the longest TEXEC and then send the read sequence, which will be acknowledged by the chip.  </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>size of rx buffer </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">response</td><td>pointer to response buffer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status of the operation </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>Run MAC test in a loop until a communication error occurs and this routine is executed. </dd></dl>

</div>
</div>
<a class="anchor" id="ab1e94f89c3aebcdd002726e9337be948"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t sha204p_send_command </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>command</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This I2C function sends a command to the device. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">count</td><td>number of bytes to send </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">command</td><td>pointer to command buffer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status of the operation </dd></dl>

</div>
</div>
<a class="anchor" id="ae7e29db9eaad7e60904776025d48c614"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sha204p_set_device_id </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This I2C function sets the I2C address. Communication functions will use this address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>I2C address </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a51b4c64d8886eb7811957f6b547578bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t sha204p_sleep </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This I2C function puts the SHA204 device into low-power state. </p>
<dl class="section return"><dt>Returns</dt><dd>status of the operation </dd></dl>

</div>
</div>
<a class="anchor" id="ae68de7f5e47843b0a8ecdd30d24442b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t sha204p_wakeup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This I2C function generates a Wake-up pulse and delays. </p>
<dl class="section return"><dt>Returns</dt><dd>status of the operation </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun May 22 2016 23:37:16 for NodaMBusGateway by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
